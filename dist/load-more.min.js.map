{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","../src/load-more.js"],"names":["LoadMore","opts","this","containerSelector","container","buttonSelector","button","linkSelector","link","removeSelector","remove","document","querySelector","setAttribute","loading","complete","setupButton","prototype","buttonEl","addEventListener","fetchMoreContent","bind","url","getAttribute","request","XMLHttpRequest","open","onload","status","handleResponse","responseText","die","onerror","send","responseDoc","createElement","innerHTML","appendContent","newContent","removePrevious","insertAdjacentHTML","itemsToRemove","querySelectorAll","i","length","parentNode","removeChild","removeAttribute","module","exports"],"mappings":"AAAA;ACKA,QAASA,UAASC,GAChBC,KAAKC,kBAAoBF,EAAKG,WAAa,mBAC3CF,KAAKG,eAAiBJ,EAAKK,QAAU,0BACrCJ,KAAKK,aAAeN,EAAKO,MAAQ,wBACjCN,KAAKO,eAAiBR,EAAKS,QAAUR,KAAKK,aAAa,KAAKL,KAAKG,eAEjEH,KAAKE,UAAYO,SAASC,cAAcV,KAAKC,mBAC7CD,KAAKE,UAAUS,aAAa,wBAAyB,IAErDX,KAAKY,SAAU,EACfZ,KAAKa,UAAW,CAEhB,IAAIT,GAASJ,KAAKE,UAAUQ,cAAcV,KAAKG,eAE5CC,IACDJ,KAAKc,YAAYV,GAQrBN,SAASiB,UAAUD,YAAc,SAASE,GACxCA,EAASC,iBAAiB,QAASjB,KAAKkB,iBAAiBC,KAAKnB,QAMhEF,SAASiB,UAAUG,iBAAmB,WACpC,IAAGlB,KAAKY,UAAWZ,KAAKa,SAAxB,CAIAb,KAAKY,SAAU,CAEf,IAAIN,GAAON,KAAKE,UAAUQ,cAAcV,KAAKK,cACzCe,EAAMd,EAAKe,aAAa,QAExBC,EAAU,GAAIC,eAClBD,GAAQE,KAAK,MAAOJ,GAAK,GAEzBE,EAAQG,OAAS,WACZH,EAAQI,QAAU,KAAOJ,EAAQI,OAAS,IAC3C1B,KAAK2B,eAAeL,EAAQM,cAE5B5B,KAAK6B,OAEPV,KAAKnB,MAEPsB,EAAQQ,QAAU9B,KAAK6B,IAAIV,KAAKnB,MAEhCsB,EAAQS,SAMVjC,SAASiB,UAAUY,eAAiB,SAASC,GAC3C,GAAII,GAAcvB,SAASwB,cAAc,OACzCD,GAAYE,UAAYN,CAExB,IAAI1B,GAAY8B,EAAYtB,cAAcV,KAAKC,kBAC/CD,MAAKmC,cAAcjC,EAAUgC,YAM/BpC,SAASiB,UAAUoB,cAAgB,SAASC,GAE1CpC,KAAKqC,iBAGLrC,KAAKE,UAAUoC,mBAAmB,YAAaF,EAE/C,IAAIhC,GAASJ,KAAKE,UAAUQ,cAAcV,KAAKG,eAE5CC,GACDJ,KAAKc,YAAYV,GAEjBJ,KAAKa,UAAW,EAGlBb,KAAKY,SAAU,GAMjBd,SAASiB,UAAUsB,eAAiB,WAGlC,IAAI,GAFAE,GAAgBvC,KAAKE,UAAUsC,iBAAiBxC,KAAKO,gBAEjDkC,EAAI,EAAGA,EAAIF,EAAcG,OAAQD,IACvCF,EAAcE,GAAGE,WAAWC,YAAYL,EAAcE,KAO1D3C,SAASiB,UAAUc,IAAM,WACvB7B,KAAKY,SAAU,EACfZ,KAAKa,UAAW,EAChBb,KAAKE,UAAU2C,gBAAgB,0BAGjCC,OAAOC,QAAUjD","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Creates a LoadMore instance.\n * @constructor\n * @param {Object} opts - Plugin options.\n */\nfunction LoadMore(opts) {\n  this.containerSelector = opts.container || '[data-load-more]';\n  this.buttonSelector = opts.button || '[data-load-more-button]';\n  this.linkSelector = opts.link || '[data-load-more-link]';\n  this.removeSelector = opts.remove || this.linkSelector+', '+this.buttonSelector;\n\n  this.container = document.querySelector(this.containerSelector);\n  this.container.setAttribute('data-load-more-active', '');\n\n  this.loading = false;\n  this.complete = false;\n\n  var button = this.container.querySelector(this.buttonSelector);\n\n  if(button) {\n    this.setupButton(button);\n  }\n}\n\n/**\n * Binds the click event for a \"load more\" button\n * @param {Object} buttonEl - Button element\n */\nLoadMore.prototype.setupButton = function(buttonEl) {\n  buttonEl.addEventListener('click', this.fetchMoreContent.bind(this));\n}\n\n/**\n * Fetch the new page content using XMLHttpRequest\n */\nLoadMore.prototype.fetchMoreContent = function() {\n  if(this.loading || this.complete) {\n    return;\n  }\n\n  this.loading = true;\n\n  var link = this.container.querySelector(this.linkSelector);\n  var url = link.getAttribute('href');\n\n  var request = new XMLHttpRequest();\n  request.open('GET', url, true);\n\n  request.onload = function() {\n    if(request.status >= 200 && request.status < 400) {\n      this.handleResponse(request.responseText);\n    } else {\n      this.die();\n    }\n  }.bind(this);\n\n  request.onerror = this.die.bind(this);\n\n  request.send();\n}\n\n/**\n * Handle the HTML response from the load more request\n */\nLoadMore.prototype.handleResponse = function(responseText) {\n  var responseDoc = document.createElement('html');\n  responseDoc.innerHTML = responseText;\n\n  var container = responseDoc.querySelector(this.containerSelector);\n  this.appendContent(container.innerHTML);\n}\n\n/**\n * Append the new content\n */\nLoadMore.prototype.appendContent = function(newContent) {\n  // Remove controls from previous page\n  this.removePrevious();\n\n  // Add new content to end of container\n  this.container.insertAdjacentHTML('beforeend', newContent);\n\n  var button = this.container.querySelector(this.buttonSelector);\n\n  if(button) {\n    this.setupButton(button);\n  } else {\n    this.complete = true;\n  }\n\n  this.loading = false;\n}\n\n/**\n * Remove leftover elements from previous page\n */\nLoadMore.prototype.removePrevious = function() {\n  var itemsToRemove = this.container.querySelectorAll(this.removeSelector);\n\n  for(var i = 0; i < itemsToRemove.length; i++) {\n    itemsToRemove[i].parentNode.removeChild(itemsToRemove[i]);\n  }\n}\n\n/**\n * Fall back to non-ajax appearance on error\n */\nLoadMore.prototype.die = function() {\n  this.loading = false;\n  this.complete = true;\n  this.container.removeAttribute('data-load-more-active');\n}\n\nmodule.exports = LoadMore;\n"]}