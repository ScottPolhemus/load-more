{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","../src/load-more.js"],"names":["LoadMore","opts","this","containerSelector","container","buttonSelector","button","linkSelector","link","removeSelector","remove","callback","document","querySelector","setAttribute","loading","complete","setupButton","prototype","buttonEl","addEventListener","fetchMoreContent","bind","url","getAttribute","request","XMLHttpRequest","open","onload","status","handleResponse","responseText","die","onerror","send","responseDoc","createElement","innerHTML","appendContent","newContent","removePrevious","insertAdjacentHTML","itemsToRemove","querySelectorAll","i","length","parentNode","removeChild","removeAttribute","module","exports"],"mappings":"AAAA;ACKA,QAASA,UAASC,GAChBC,KAAKC,kBAAoBF,EAAKG,WAAa,mBAC3CF,KAAKG,eAAiBJ,EAAKK,QAAU,0BACrCJ,KAAKK,aAAeN,EAAKO,MAAQ,wBACjCN,KAAKO,eAAiBR,EAAKS,QAAUR,KAAKK,aAAa,KAAKL,KAAKG,eACjEH,KAAKS,SAAWV,EAAKU,UAAY,KAEjCT,KAAKE,UAAYQ,SAASC,cAAcX,KAAKC,mBAC7CD,KAAKE,UAAUU,aAAa,wBAAyB,IAErDZ,KAAKa,SAAU,EACfb,KAAKc,UAAW,CAEhB,IAAIV,GAASJ,KAAKE,UAAUS,cAAcX,KAAKG,eAE5CC,IACDJ,KAAKe,YAAYX,GAQrBN,SAASkB,UAAUD,YAAc,SAASE,GACxCA,EAASC,iBAAiB,QAASlB,KAAKmB,iBAAiBC,KAAKpB,QAMhEF,SAASkB,UAAUG,iBAAmB,WACpC,IAAGnB,KAAKa,UAAWb,KAAKc,SAAxB,CAIAd,KAAKa,SAAU,CAEf,IAAIP,GAAON,KAAKE,UAAUS,cAAcX,KAAKK,cACzCgB,EAAMf,EAAKgB,aAAa,QAExBC,EAAU,GAAIC,eAClBD,GAAQE,KAAK,MAAOJ,GAAK,GAEzBE,EAAQG,OAAS,WACZH,EAAQI,QAAU,KAAOJ,EAAQI,OAAS,IAC3C3B,KAAK4B,eAAeL,EAAQM,cAE5B7B,KAAK8B,OAEPV,KAAKpB,MAEPuB,EAAQQ,QAAU/B,KAAK8B,IAAIV,KAAKpB,MAEhCuB,EAAQS,SAMVlC,SAASkB,UAAUY,eAAiB,SAASC,GAC3C,GAAII,GAAcvB,SAASwB,cAAc,OACzCD,GAAYE,UAAYN,CAExB,IAAI3B,GAAY+B,EAAYtB,cAAcX,KAAKC,kBAC/CD,MAAKoC,cAAclC,EAAUiC,WAED,kBAAlBnC,MAAKS,UACbT,KAAKS,YAOTX,SAASkB,UAAUoB,cAAgB,SAASC,GAE1CrC,KAAKsC,iBAGLtC,KAAKE,UAAUqC,mBAAmB,YAAaF,EAE/C,IAAIjC,GAASJ,KAAKE,UAAUS,cAAcX,KAAKG,eAE5CC,GACDJ,KAAKe,YAAYX,GAEjBJ,KAAKc,UAAW,EAGlBd,KAAKa,SAAU,GAMjBf,SAASkB,UAAUsB,eAAiB,WAGlC,IAAI,GAFAE,GAAgBxC,KAAKE,UAAUuC,iBAAiBzC,KAAKO,gBAEjDmC,EAAI,EAAGA,EAAIF,EAAcG,OAAQD,IACvCF,EAAcE,GAAGE,WAAWC,YAAYL,EAAcE,KAO1D5C,SAASkB,UAAUc,IAAM,WACvB9B,KAAKa,SAAU,EACfb,KAAKc,UAAW,EAChBd,KAAKE,UAAU4C,gBAAgB,0BAGjCC,OAAOC,QAAUlD","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Creates a LoadMore instance.\n * @constructor\n * @param {Object} opts - Plugin options.\n */\nfunction LoadMore(opts) {\n  this.containerSelector = opts.container || '[data-load-more]';\n  this.buttonSelector = opts.button || '[data-load-more-button]';\n  this.linkSelector = opts.link || '[data-load-more-link]';\n  this.removeSelector = opts.remove || this.linkSelector+', '+this.buttonSelector;\n  this.callback = opts.callback || null;\n\n  this.container = document.querySelector(this.containerSelector);\n  this.container.setAttribute('data-load-more-active', '');\n\n  this.loading = false;\n  this.complete = false;\n\n  var button = this.container.querySelector(this.buttonSelector);\n\n  if(button) {\n    this.setupButton(button);\n  }\n}\n\n/**\n * Binds the click event for a \"load more\" button\n * @param {Object} buttonEl - Button element\n */\nLoadMore.prototype.setupButton = function(buttonEl) {\n  buttonEl.addEventListener('click', this.fetchMoreContent.bind(this));\n}\n\n/**\n * Fetch the new page content using XMLHttpRequest\n */\nLoadMore.prototype.fetchMoreContent = function() {\n  if(this.loading || this.complete) {\n    return;\n  }\n\n  this.loading = true;\n\n  var link = this.container.querySelector(this.linkSelector);\n  var url = link.getAttribute('href');\n\n  var request = new XMLHttpRequest();\n  request.open('GET', url, true);\n\n  request.onload = function() {\n    if(request.status >= 200 && request.status < 400) {\n      this.handleResponse(request.responseText);\n    } else {\n      this.die();\n    }\n  }.bind(this);\n\n  request.onerror = this.die.bind(this);\n\n  request.send();\n}\n\n/**\n * Handle the HTML response from the load more request\n */\nLoadMore.prototype.handleResponse = function(responseText) {\n  var responseDoc = document.createElement('html');\n  responseDoc.innerHTML = responseText;\n\n  var container = responseDoc.querySelector(this.containerSelector);\n  this.appendContent(container.innerHTML);\n\n  if(typeof this.callback === 'function') {\n    this.callback();\n  }\n}\n\n/**\n * Append the new content\n */\nLoadMore.prototype.appendContent = function(newContent) {\n  // Remove controls from previous page\n  this.removePrevious();\n\n  // Add new content to end of container\n  this.container.insertAdjacentHTML('beforeend', newContent);\n\n  var button = this.container.querySelector(this.buttonSelector);\n\n  if(button) {\n    this.setupButton(button);\n  } else {\n    this.complete = true;\n  }\n\n  this.loading = false;\n}\n\n/**\n * Remove leftover elements from previous page\n */\nLoadMore.prototype.removePrevious = function() {\n  var itemsToRemove = this.container.querySelectorAll(this.removeSelector);\n\n  for(var i = 0; i < itemsToRemove.length; i++) {\n    itemsToRemove[i].parentNode.removeChild(itemsToRemove[i]);\n  }\n}\n\n/**\n * Fall back to non-ajax appearance on error\n */\nLoadMore.prototype.die = function() {\n  this.loading = false;\n  this.complete = true;\n  this.container.removeAttribute('data-load-more-active');\n}\n\nmodule.exports = LoadMore;\n"]}